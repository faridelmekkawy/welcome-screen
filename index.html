<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
  <title>Welcome Display — Soueast</title>

  <!-- Premium display font -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet"/>

  <link rel="icon" href="https://cdn.jsdelivr.net/gh/faridelmekkawy/welcome-screen@dd7ba29c3fa0b89c70e7d7870eec2d4cb7bebb53/public/screen2.png"/>

  <style>
    :root{
      --fade:.35s;
      --ink:#fff;
      --veil:linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.78));
      --img-url:url("https://cdn.jsdelivr.net/gh/faridelmekkawy/welcome-screen@dd7ba29c3fa0b89c70e7d7870eec2d4cb7bebb53/public/screen2.png");

      /* original hitbox settings */
      --box-top: 50.3%;
      --box-height: 9.4%;
      --box-left: 6%;
      --box-right: 6%;

      --gold1:#e7c072; --gold2:#f6e6b8; --gold3:#b88a3d;
    }

    *{box-sizing:border-box}
    html,body{
      height:100%; margin:0; background:#000; color:var(--ink);
      font-family:"Montserrat", system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    .stage{position:fixed; inset:0; overflow:hidden}

    /* Background video — original scaling (not zoomed) */
    .video{position:absolute; inset:0; transition:opacity var(--fade) ease}
    .video.hidden{opacity:0; pointer-events:none}
    video{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; background:#000}
    @media (min-aspect-ratio:16/10){
      video{object-fit:contain; background:#000}
    }

    /* Depth overlay */
    .stage::after{
      content:""; position:fixed; inset:0; pointer-events:none; z-index:0;
      background: radial-gradient(120% 90% at 50% 40%, rgba(0,0,0,0), rgba(0,0,0,.28));
    }
    .stage::before{
      content:""; position:fixed; inset:0; z-index:0; pointer-events:none;
      background-image: url('data:image/svg+xml;utf8,\
      <svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160">\
      <filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2" stitchTiles="stitch"/></filter>\
      <rect width="100%" height="100%" filter="url(%23n)" opacity=".05"/></svg>');
      mix-blend-mode: overlay; opacity:.32;
    }

    /* Overlay */
    .overlay{
      position:absolute; inset:0; display:grid; place-items:center;
      background:var(--veil); opacity:0; pointer-events:none; transition:opacity var(--fade) ease;
    }
    .overlay.visible{opacity:1; pointer-events:auto}

    /* Frame with new PNG */
    .frame{
      width:clamp(280px, 70vmin, 980px);
      aspect-ratio:768/1365;
      background:center/cover no-repeat var(--img-url);
      position:relative; border-radius:22px;
      box-shadow:0 24px 96px rgba(0,0,0,.55);
    }

    .name-box{
      position:absolute;
      left:var(--box-left); right:var(--box-right);
      top:var(--box-top); height:var(--box-height);
      display:flex; align-items:center; justify-content:center;
      padding:.3rem .8rem;
    }

    .name{
      width:100%; text-align:center; font-weight:900; text-transform:uppercase;
      color:#fff; text-shadow:0 3px 12px rgba(0,0,0,.55);
      white-space:nowrap; overflow:hidden;
      line-height:1.0;
      letter-spacing:.01em;
      font-size:clamp(22px,6.5vmin,72px);
      transform:translateY(1px);
    }

    @keyframes namePop{
      0%{transform:translateY(7px)scale(.96);letter-spacing:.08em;opacity:0}
      60%{transform:translateY(1px)scale(1.02);letter-spacing:.015em;opacity:1}
      100%{transform:translateY(1px)scale(1);letter-spacing:.01em}
    }
    .name.sheen{
      position:relative;isolation:isolate;
      background:linear-gradient(90deg,var(--gold3),var(--gold2),var(--gold1));
      -webkit-background-clip:text;background-clip:text;color:transparent;
      animation:namePop .85s cubic-bezier(.2,.8,.2,1);
    }
    .name.sheen::after{
      content:"";position:absolute;inset:0;z-index:-1;
      background:linear-gradient(115deg,transparent 35%,rgba(255,255,255,.55)50%,transparent 65%);
      transform:skewX(-18deg)translateX(-120%);
      animation:sweep 1.2s .15s ease-out both;
      pointer-events:none;
    }
    @keyframes sweep{to{transform:skewX(-18deg)translateX(140%);opacity:0}}

    .name-underline{
      position:absolute;left:18%;right:18%;
      bottom:calc((100%-var(--box-height))*-0.18);
      height:3px;border-radius:999px;
      background:linear-gradient(90deg,transparent,var(--gold2),transparent);
      transform-origin:center;transform:scaleX(0);
      animation:underlineGrow .7s .25s cubic-bezier(.2,.8,.2,1)forwards;
    }
    @keyframes underlineGrow{to{transform:scaleX(1)}}

    .status{position:fixed;left:10px;bottom:10px;font:12px ui-monospace,monospace;opacity:.85;color:#0ff}
  </style>
</head>
<body>
  <div class="stage">
    <!-- Background video -->
    <div class="video" id="videoWrap">
      <video id="bgVideo" autoplay muted loop playsinline preload="auto"
        poster="https://cdn.jsdelivr.net/gh/faridelmekkawy/welcome-screen@dd7ba29c3fa0b89c70e7d7870eec2d4cb7bebb53/public/screen2.png">
        <source src="https://cdn.jsdelivr.net/gh/faridelmekkawy/welcome-screen@1282265f9fa3a3359587bb62544ec0e80464637a/public/screen%201.%20H.mp4" type="video/mp4"/>
      </video>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay">
      <div class="frame">
        <div class="name-box">
          <div class="name" id="nameEl">GUEST NAME</div>
          <div class="name-underline" id="nameUL"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="status" id="status">state: video • initializing…</div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/11.0.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.2/firebase-database-compat.js"></script>

  <script>
    const SHOW_MS=5000,EVENT_ID="Soueast",WATCH_NAME=`events/${EVENT_ID}/welcome/latest/name`;
    const firebaseConfig={apiKey:"AIzaSyA80bAAGPuyscnTVS-zwrxE9Jp3tPiS1gM",authDomain:"events-339ce.firebaseapp.com",databaseURL:"https://events-339ce-default-rtdb.europe-west1.firebasedatabase.app",projectId:"events-339ce",storageBucket:"events-339ce.appspot.com",messagingSenderId:"175601544315",appId:"1:175601544315:web:00c94b4affa972b3a286de"};
    firebase.initializeApp(firebaseConfig);

    const db=firebase.database(),statusEl=document.getElementById("status"),videoWrap=document.getElementById("videoWrap"),overlay=document.getElementById("overlay"),nameEl=document.getElementById("nameEl"),nameUL=document.getElementById("nameUL"),bgVideo=document.getElementById("bgVideo"),showStatus=msg=>statusEl.textContent=msg;

    document.addEventListener("DOMContentLoaded",async()=>{try{bgVideo.muted=true;await bgVideo.play();showStatus("state: video • playing")}catch{showStatus("state: video • click to start");document.addEventListener("click",()=>bgVideo.play(),{once:true})}});

    function setState(mode,msg=""){if(mode==="image"){videoWrap.classList.add("hidden");overlay.classList.add("visible");try{bgVideo.pause()}catch{}}else{overlay.classList.remove("visible");videoWrap.classList.remove("hidden");bgVideo.muted=true;bgVideo.play().catch(()=>{})}showStatus(`state: ${mode} • ${msg}`)}

    function fitText(el){el.style.fontSize="";el.style.letterSpacing=".01em";const parent=el.parentElement;let size=parseFloat(getComputedStyle(el).fontSize);const min=14;while(size>min&&el.scrollWidth>parent.clientWidth){size-=1;el.style.fontSize=size+"px";if(size<34)el.style.letterSpacing="0";if(size<26)el.style.letterSpacing="-0.01em"}el.style.transform="translateY(1px)"}

    let timer=null,showing=false,lastName="";
    function showName(fullName){showing=true;const text=String(fullName||"Guest").trim().toUpperCase();nameEl.textContent=text;nameEl.classList.remove("sheen");void nameEl.offsetWidth;nameEl.classList.add("sheen");if(nameUL){nameUL.style.animation="none";void nameUL.offsetWidth;nameUL.style.animation="underlineGrow .7s .25s cubic-bezier(.2,.8,.2,1) forwards"}requestAnimationFrame(()=>fitText(nameEl));setState("image",`showing "${text}"`);clearTimeout(timer);timer=setTimeout(()=>{setState("video","auto-revert");showing=false},SHOW_MS)}

    const refName=db.ref(WATCH_NAME);
    refName.on("value",snap=>{const name=(snap.val()??"").toString().trim();if(!name){if(!overlay.classList.contains("visible"))setState("video","waiting…");return;}if(name!==lastName){lastName=name;showName(name)}},err=>{console.warn("[DB] error",err);showStatus("state: video • db error")});

    setState("video","listening…");
  </script>
</body>
</html>
